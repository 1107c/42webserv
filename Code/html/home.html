
       <!-- <script >
           function deleteFile() {
               var filename = document.getElementById('deleteFileName').value;
               if (!filename) {
                   return;
               }
               fetch('http://127.0.0.1:8000/uploaded/' + filename, {
                   method: 'DELETE'
               })
               .then(response => {
                   document.getElementById('deleteFileName').value = '';  // 입력창 초기화
               })
               .catch(error => {
                   console.error('Error:', error);
               });
           }
       </script>
 
</body>
   <body>
       <h1>Test</h1>
       <p>Hello</p>
       <form method="POST" enctype="multipart/form-data">
           <input type="file" name="file" id="imageFileOpenInput" accept="image/*" required>
           <button type="submit">Upload</button>
       </form>

       <div>
           <h3>Delete File</h3>
           <input type="text" id="deleteFileName" placeholder="Enter filename to delete">
           <button onclick="deleteFile()">Delete File</button>
       </div>
   </body> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>파일 선택 유지</title>
    <style>
        #custom-file-label {
            display: inline-block;
            margin-left: 10px;
            font-weight: bold;
            color: #333;
        }
        #custom-file-button {
            display: inline-block;
            padding: 5px 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
        }
        #custom-file-button:hover {
            background-color: #0056b3;
        }
        #preview {
            display: block;
            margin-top: 20px;
            max-width: 300px;
            max-height: 300px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <h1>파일 선택 유지</h1>
    <form id="upload-form" method="POST" enctype="multipart/form-data">
        <input type="file" id="image" name="image" accept="image/*" style="display: none;">
        <button type="button" id="custom-file-button">파일 선택</button>
        <span id="custom-file-label">선택된 파일 없음</span>
        <br><br>
        <button type="submit">제출</button>
    </form>
    <p id="upload-status"></p>
    <img style="display: none;" id="preview" src="./image/gyeongju.jpeg" alt="기본 이미지">

    <script>
		let data;
		(async function() {
			setTimeout(async () => {
				try {
					const response = await fetch('/check-id', {
						method: 'GET'
					});

					data = await response.json();
					console.log("data: ", data);
					if (data.status != 'login')
						window.location.href = '/';
					else
					{
						const path = data.path ? data.path : ""
						if (path)
							document.getElementById("preview").src = path;
						document.getElementById("preview").style.display = "block";
					}
				} catch(error)
				{
					console.log(error);
					window.location.href = '/error';
				}
			}, 100)
		}());

        const fileInput = document.getElementById('image');
        const customButton = document.getElementById('custom-file-button');
        const customLabel = document.getElementById('custom-file-label');
        const preview = document.getElementById('preview');

        // 이전 파일 저장
        let previousFile = null;

        // 커스텀 버튼 클릭 시 파일 선택 창 열기
        customButton.addEventListener('click', () => {
            fileInput.click();
        });

        // 파일 선택 시 처리
        fileInput.addEventListener('change', () => {
			console.log("previusFile: ", previousFile);
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                previousFile = file;

                // 파일 이름 및 미리보기 업데이트
                customLabel.textContent = file.name;
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                };
                reader.readAsDataURL(file);
            } else if (previousFile) {
                // 취소한 경우 기존 파일 이름과 미리보기 유지
                customLabel.textContent = previousFile.name;
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.src = e.target.result;
                };
                reader.readAsDataURL(previousFile);
            } else {
                // 기본 상태 유지
                customLabel.textContent = "선택된 파일 없음";
                preview.src = "./image/gyeongju.jpeg";
            }
        });

		document.querySelector('#upload-form').addEventListener('submit', async function(event) {
			event.preventDefault();
			// const fileInput = document.getElementById('image');
			const uploadStatus = document.getElementById('upload-status');
			if (!previousFile) {
				// console.log("fileInput: ", fileInput.files);
                uploadStatus.textContent = "파일을 선택해주세요.";
                uploadStatus.style.color = "red";
                return;
            }
            const formData = new FormData();
            formData.append('image', previousFile);
			// formData.append('userid', data.id);
			// console.log('filename', formData.get('image').name);
			// console.log('userid:', formData.get('userid'));

            try {
                const response = await fetch('/uploaded', {
                    method: 'POST',
                    body: formData,
                });
				const data = await response.text();
				
				if (data === "success")
				{
					alert("파일 업로드 성공!");
				}
				else
				{
					alert("파일 업로드 중 에러 발생!");
				}
                // if (response.ok) {
                //     const result = await response.json();
                //     uploadStatus.textContent = result.message || "업로드 성공!";
                //     uploadStatus.style.color = "green";
                // } else {
                //     uploadStatus.textContent = "업로드 실패: 서버 오류";
                //     uploadStatus.style.color = "red";
                // }
            } catch (error) {
                console.error('업로드 중 오류:', error);
                uploadStatus.textContent = "업로드 실패: 네트워크 오류";
                uploadStatus.style.color = "red";
            }
	    });
    </script>
</body>
</html>